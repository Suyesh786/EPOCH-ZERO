<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Tutor Bot</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto+Mono&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
background:#050a14;
font-family:'Roboto Mono',monospace;
height:100vh;
display:flex;
justify-content:center;
align-items:center;
color:#00f3ff;
}

.interface-container{
width:90%;
max-width:1000px;
height:80vh;
display:flex;
border:2px solid #00f3ff;
border-radius:20px;
background:radial-gradient(circle at 30% 50%,#0a1525,#050a14);
box-shadow:0 0 30px rgba(0,243,255,.2);
position:relative;
}

.bot-visual{
flex:1;
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
border-right:1px solid rgba(0,243,255,.3);
}

.hologram-circle{
width:200px;
height:200px;
border-radius:50%;
border:2px solid #00f3ff;
display:flex;
align-items:center;
justify-content:center;
box-shadow:0 0 20px #00f3ff,inset 0 0 20px #00f3ff;
animation:pulse 3s infinite;
}

.bot-icon{
font-size:5rem;
color:white;
text-shadow:0 0 10px #00f3ff;
}

@keyframes pulse{
50%{box-shadow:0 0 40px #00f3ff,inset 0 0 40px #00f3ff}
}

.chat-area{
flex:1.5;
display:flex;
flex-direction:column;
padding:30px;
}

.chat-history{
flex:1;
overflow-y:auto;
border-bottom:1px solid rgba(0,243,255,.3);
padding-right:10px;
margin-bottom:15px;
}

.message{
margin-bottom:12px;
padding:10px 15px;
border-radius:10px;
max-width:80%;
font-size:.9rem;
}

.user-msg{
background:rgba(0,243,255,.1);
border:1px solid #00f3ff;
margin-left:auto;
color:white;
}

.bot-msg{
background:rgba(255,255,255,.05);
border:1px dashed rgba(0,243,255,.5);
color:#00f3ff;
}

.input-group{
display:flex;
flex-direction:column;
gap:12px;
}

.sketch-input{
background:transparent;
border:2px solid #00f3ff;
border-radius:10px;
padding:14px;
color:white;
outline:none;
font-family:'Roboto Mono';
}

.controls{
display:flex;
gap:10px;
}

.send-btn{
background:#00f3ff;
color:#050a14;
border:none;
padding:10px;
border-radius:6px;
font-weight:bold;
cursor:pointer;
font-family:'Orbitron';
letter-spacing:1px;
}

.back-btn{
position:absolute;
top:20px;
right:20px;
color:rgba(255,255,255,.6);
text-decoration:none;
}
</style>
</head>

<body>

<div class="interface-container">

<a href="student_lessons.html" class="back-btn">X CLOSE</a>

<div class="bot-visual">
<div class="hologram-circle">
<i class="fas fa-headset bot-icon"></i>
</div>
<p style="margin-top:15px;letter-spacing:2px">AI TUTOR V1.0</p>
</div>

<div class="chat-area">

<div class="chat-history" id="chat-history">
<div class="message bot-msg">HELLO STUDENT. ASK ME ANY QUESTION.</div>
</div>

<div class="input-group">
<input class="sketch-input" id="user-input" placeholder="TYPE YOUR QUESTION...">

<div class="controls">
<button class="send-btn" onclick="sendMessage()">SEND</button>
<button class="send-btn" onclick="startMic()">ðŸŽ¤</button>

<label class="send-btn">
ðŸ“·
<input hidden type="file" accept="image/*" onchange="sendImage(event)">
</label>
</div>

</div>
</div>
</div>

<script>

const chatBox = document.getElementById("chat-history");

function addMsg(text,type){
const div=document.createElement("div");
div.className="message "+type;
div.innerText=text;
chatBox.appendChild(div);
chatBox.scrollTop=chatBox.scrollHeight;
}

// ---------------- TEXT CHAT ----------------

async function sendMessage(){
const input=document.getElementById("user-input");
const msg=input.value.trim();
if(!msg) return;

addMsg(msg,"user-msg");
input.value="";
addMsg("THINKING...","bot-msg");

const res=await fetch("http://localhost:3001/chat",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({message:msg})
});

const data=await res.json();
chatBox.lastChild.innerText=data.reply;
}

// ---------------- MICROPHONE ----------------

const SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;
const mic=new SpeechRecognition();

mic.onresult=e=>{
document.getElementById("user-input").value=e.results[0][0].transcript;
};

function startMic(){
mic.start();
}

// ---------------- IMAGE ----------------

async function sendImage(e){
const file=e.target.files[0];
if(!file) return;

addMsg("Analyzing image...","bot-msg");

const form=new FormData();
form.append("image",file);

const res=await fetch("http://localhost:3001/analyze-image",{
method:"POST",
body:form
});

const data=await res.json();
chatBox.lastChild.innerText=data.reply;
}

</script>

</body>
</html>
